<div class="flex justify-center flex-col lg:flex-row container mx-auto">
  <!-- Left panel: the grid -->
  <div class="inventory-view container">
    @for (row of hotmServ.grid; let rwIdx = $index; track rwIdx) {
      @for (cell of row; let colIdx = $index; track colIdx) {
        @if (cell) {
          <div class="inventory-slot rich-item"
               (click)="onCellClick(colIdx, rwIdx)"
               [id]="'cell_' + colIdx + '_' + rwIdx"
               [ngClass]="{'selected': selectedPos()?.x === colIdx && selectedPos()!.y === rwIdx}"
          >
            <div class="item-icon piece-icon" [ngClass]="cell.cssClass()()"></div>
          </div>
        } @else {
          <div class="inventory-slot" [id]="'cell_' + colIdx + '_' + rwIdx"></div>
        }
      }
    }
  </div>
  <!-- Right panel: the picker -->
  <div class="container flex justify-center">
    <div class="my-auto tooltip-mc">
      @if (selectedPos()) {
        @let pos = selectedPos()!;
        @let selectedNode = hotmServ.grid[pos.y][pos.x];
        @switch (selectedNode.type) {
          @case ('ability') {
            <sb-hotm-card [instance]="selectedNode" [isLevelable]="false"/>
          }
          @case ('static') {
            <sb-hotm-card [instance]="selectedNode" [isLevelable]="false"/>
          }
          @case ('levelable') {
            <sb-hotm-card [instance]="selectedNode" [isLevelable]="true"/>
          }
        }
      } @else {
        <div class="flex flex-col justify-center items-center">
          <span class="mc gray">Select a perk to see its description!</span>
        </div>
      }
    </div>
  </div>
</div>
